<!DOCTYPE html>

<html lang="es">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="referrer" content="no-referrer">

    <title>Catálogo Mejorado - CACAHUATE NATURAL MARKET</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Merriweather:wght@400;700;900&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>

        :root {

            --fondo-oscuro: #1A1A1A;

            --fondo-claro-secundario: #282828;

            --fondo-tarjeta: #2F2F2F;

            --texto-claro: #F8F8F8;

            --azul-terroso-claro: #C2E2DA;

            --marron-oscuro-texto: #C0C0C0;

            --blanco-puro: #FFFFFF;

            --naranja-cacahuate: #FFC107;

            --verde-whatsapp: #25D366;

            --verde-confirmacion: #5cb85c;

            --rojo-error: #ff6b6b;

        }

        html { scroll-behavior: smooth; }

        body {

            font-family: 'Inter', sans-serif;

            margin: 0;

            padding: 0;

            background-color: var(--fondo-oscuro);

            color: var(--texto-claro);

            line-height: 1.6;

        }

        header {

            position: relative;

            color: var(--blanco-puro);

            text-align: center;

            box-shadow: 0 6px 12px rgba(0,0,0,0.5);

            overflow: hidden;

        }

        .header-background {

            position: absolute;

            top: 0; left: 0;

            width: 100%; height: 100%;

            z-index: 1;

        }

        .header-background img {

            width: 100%;

            height: 100%;

            object-fit: cover;

            object-position: center;

        }

        .header-background::after {

            content: '';

            position: absolute;

            top: 0; left: 0;

            width: 100%; height: 100%;

            background-color: rgba(0, 0, 0, 0.6);

        }

        .header-content {

            position: relative;

            z-index: 2;

            padding: 30px 20px;

        }

        .logo-container {

            max-width: 300px;

            margin: 20px auto;

        }

        .logo-container img {

            max-width: 100%;

            transition: transform 0.3s ease, filter 0.3s ease;

        }

        .logo-container img:hover {

            transform: scale(1.05);

            filter: brightness(1.2) saturate(1.2);

        }

        .address-container {

            background-color: rgba(0,0,0,0.5);

            padding: 15px 20px;

            text-align: center;

            margin-top: 20px;

            display: inline-block;

            border-radius: 8px;

        }

        .address-header {

            color: var(--naranja-cacahuate);

            font-size: 1.2em;

            font-weight: 700;

            margin: 0;

        }

        .address-header i { margin-right: 8px; }

        .main-nav {

            background-color: rgba(26, 26, 26, 0.9);

            backdrop-filter: blur(10px);

            padding: 10px 20px;

            position: sticky;

            top: 0;

            z-index: 999;

            box-shadow: 0 4px 12px rgba(0,0,0,0.3);

            display: flex;

            justify-content: space-between;

            align-items: center;

            min-height: 40px; /* Altura mínima para que 60px sea consistente */

        }

        .nav-links {

            display: flex;

            justify-content: center;

            align-items: center;

            gap: 5px;

            flex-wrap: wrap;

        }

        .main-nav a, .dropdown .dropbtn {

            color: var(--naranja-cacahuate);

            text-decoration: none;

            font-weight: 700;

            padding: 8px 15px;

            border-radius: 8px;

            transition: background-color 0.3s, color 0.3s;

            cursor: pointer;

            background: none;

            border: none;

            font-size: 1em;

            font-family: 'Inter', sans-serif;

        }

        .main-nav a:hover, .dropdown:hover .dropbtn {

            background-color: var(--naranja-cacahuate);

            color: var(--fondo-oscuro);

        }

        .dropdown { position: relative; display: inline-block; }

        .dropdown-content {

            display: none;

            position: absolute;

            background-color: var(--fondo-claro-secundario);

            min-width: 200px;

            box-shadow: 0 8px 16px rgba(0,0,0,0.2);

            z-index: 1;

            border-radius: 8px;

            padding: 10px 0;

            margin-top: 5px;

        }

        .dropdown-content a {

            color: var(--naranja-cacahuate);

            padding: 12px 16px;

            text-decoration: none;

            display: block;

            text-align: left;

        }

        .dropdown-content a:hover {

            background-color: var(--naranja-cacahuate);

            color: var(--fondo-oscuro);

        }

        .dropdown:hover .dropdown-content { display: block; }

        .hamburger-menu {

            display: none;

            font-size: 24px;

            background: none; border: none;

            color: var(--naranja-cacahuate);

            cursor: pointer;

        }

        .content-section {

            padding: 50px 30px;

            text-align: center;

            max-width: 1400px;

            margin: 0 auto 40px;

            scroll-margin-top: 80px;

        }

        .content-section h1 {

            font-family: 'Merriweather', serif;

            margin: 0 0 20px;

            font-size: 3.8em;

            color: var(--naranja-cacahuate);

            text-shadow: 0 0 10px rgba(255,140,0,0.5);

        }

        .content-section p {

            font-size: 1.2em;

            color: var(--naranja-cacahuate);

            max-width: 1000px;

            margin: 15px auto;

        }

        .search-bar-container {

            background-color: var(--fondo-claro-secundario);

            padding: 25px 20px;

            max-width: 1000px;

            margin: 40px auto 20px;

            border-radius: 15px;

            box-shadow: 0 4px 10px rgba(0,0,0,0.3);

            display: flex;

            align-items: center;

        }

        .search-bar-container i {

            color: var(--naranja-cacahuate);

            font-size: 1.6em;

            margin-right: 15px;

        }

        .search-bar-container input {

            flex-grow: 1;

            padding: 12px 15px;

            border: none;

            border-radius: 8px;

            font-size: 1.1em;

            background-color: #3A3A3A;

            color: var(--texto-claro);

            outline: none;

        }

        .cards-grid {

            padding: 50px 40px;

            max-width: 1400px;

            margin: 0 auto 40px;

            background-color: var(--fondo-claro-secundario);

            border-radius: 25px;

            box-shadow: 0 15px 40px rgba(0,0,0,0.6);

            display: grid;

            grid-template-columns: repeat(4, 1fr);

            gap: 50px;

            transition: opacity 0.3s ease;

        }

        .no-results-message {

            display: none;

            padding: 50px;

            color: var(--naranja-cacahuate);

            font-size: 1.8em;

            text-align: center;

            grid-column: 1 / -1;

        }

        .card {

            background-color: var(--fondo-tarjeta);

            border-radius: 20px;

            box-shadow: 0 8px 20px rgba(0,0,0,0.4);

            overflow: hidden;

            transition: transform 0.4s, box-shadow 0.4s;

            display: flex;

            flex-direction: column;

        }

        .card:hover {

            transform: translateY(-12px);

            box-shadow: 0 18px 40px rgba(0,0,0,0.55);

        }

        .card .image-wrapper, .card .image-gallery {

            width: 100%;

            height: 250px;

            background-color: var(--blanco-puro);

            padding: 10px;

            box-sizing: border-box;

            display: flex;

            flex-direction: column;

            justify-content: center;

            align-items: center;

        }

        .card .main-image-container {

            width: 100%;

            flex-grow: 1;

            cursor: pointer;

            display: flex;

            align-items: center;

            justify-content: center;

            overflow: hidden;

        }

        .card .main-image, .card .image-wrapper img {

            max-width: 100%;

            max-height: 100%;

            object-fit: contain;

            transition: transform 0.3s ease;

        }

        .card:hover .main-image, .card:hover .image-wrapper img {

            transform: scale(1.05);

        }

        .card .thumbnail-container {

            display: flex;

            justify-content: center;

            gap: 5px;

            height: 40px;

            margin-top: 10px;

            flex-shrink: 0;

        }

        .card .thumbnail {

            width: 40px;

            height: 40px;

            object-fit: contain;

            cursor: pointer;

            border: 2px solid transparent;

            border-radius: 4px;

            transition: border-color 0.3s;

            background-color: var(--blanco-puro);

            padding: 2px;

        }

        .card .thumbnail:hover, .card .thumbnail.active {

            border-color: var(--naranja-cacahuate);

        }

        .card-content {

            padding: 20px;

            flex-grow: 1;

            display: flex;

            flex-direction: column;

            justify-content: space-between;

        }

        .card h3 {

            font-family: 'Merriweather', serif;

            color: var(--naranja-cacahuate);

            margin: 0 0 15px 0;

            font-size: 1.6em;

        }

        .card .description {

            color: var(--marron-oscuro-texto);

            font-size: 1em;

            margin-bottom: 20px;

            display: -webkit-box;

            -webkit-line-clamp: 3;

            line-clamp: 3;

            -webkit-box-orient: vertical;

            overflow: hidden;

            min-height: 75px;

        }

        .card .card-actions {

            display: flex;

            justify-content: space-between;

            align-items: center;

            margin-top: auto;

        }

        .card .add-to-cart-btn {

            background-color: var(--naranja-cacahuate);

            color: var(--fondo-oscuro);

            border: none;

            padding: 10px 15px;

            border-radius: 8px;

            cursor: pointer;

            font-weight: 700;

            transition: background-color 0.3s, transform 0.3s;

        }

        .card .details-btn {

            background: none; border: none;

            color: var(--azul-terroso-claro);

            font-size: 1.5em;

            cursor: pointer;

            transition: transform 0.3s, color 0.3s;

        }

        .card .details-btn:hover {

            color: var(--blanco-puro);

            transform: scale(1.2);

        }

        .card .quantity-selector {

            display: flex;

            align-items: center;

            gap: 10px;

        }

        .card .quantity-btn {

            background-color: var(--naranja-cacahuate);

            color: var(--fondo-oscuro);

            border: none;

            width: 30px;

            height: 30px;

            border-radius: 50%;

            font-size: 1.2em;

            font-weight: bold;

            cursor: pointer;

            transition: transform 0.2s;

        }

        .card .quantity-btn:hover {

            transform: scale(1.1);

        }

        .card .quantity-input {

            width: 40px;

            text-align: center;

            font-size: 1.2em;

            border: 1px solid var(--fondo-tarjeta);

            background-color: var(--fondo-claro-secundario);

            color: var(--texto-claro);

            border-radius: 8px;

            -moz-appearance: textfield;

            appearance: none;

        }

        .card .quantity-input::-webkit-outer-spin-button,

        .card .quantity-input::-webkit-inner-spin-button {

            -webkit-appearance: none;

            margin: 0;

        }

        .modal {

            display: none;

            position: fixed;

            z-index: 1000;

            left: 0; top: 0;

            width: 100%; height: 100%;

            background-color: rgba(0,0,0,0.8);

            justify-content: center;

            align-items: center;

            backdrop-filter: blur(8px);

        }

        .modal-content {

            background-color: var(--fondo-tarjeta);

            padding: 30px;

            border-radius: 20px;

            max-width: 90%;

            max-height: 90vh;

            width: 600px;

            box-shadow: 0 0 20px rgba(0,0,0,0.5);

            position: relative;

            overflow-y: auto;

        }

        .close-button {

            position: absolute;

            top: 15px; right: 25px;

            color: #f1f1f1;

            font-size: 40px;

            font-weight: bold;

            cursor: pointer;

        }

        #productModal .modal-content img {

            width: 100%; height: 300px;

            object-fit: contain;

            border-radius: 15px;

            background-color: var(--blanco-puro);

            margin-bottom: 20px;

        }

        #productModal h3 {

            font-family: 'Merriweather', serif;

            color: var(--naranja-cacahuate);

            font-size: 2.5em;

            margin: 0 0 15px 0;

        }

        .modal-whatsapp-btn {

            display: inline-block;

            background-color: var(--verde-whatsapp);

            color: white;

            padding: 12px 20px;

            border-radius: 8px;

            text-decoration: none;

            font-weight: 700;

            text-align: center;

            transition: background-color 0.3s, transform 0.3s;

        }

        .modal-whatsapp-btn:hover {

            background-color: #128C7E;

            transform: scale(1.05);

        }

        .modal-whatsapp-btn i { margin-right: 8px; }

        #imageZoomModal .modal-content {

            background: transparent;

            padding: 0;

            width: auto; height: auto;

            max-width: 90vw; max-height: 90vh;

            box-shadow: none;

        }

        #zoomImg {

            width: 100%; height: 100%;

            object-fit: contain;

            border-radius: 10px;

        }

        .cart-btn {

            position: fixed;

            bottom: 20px; right: 20px;

            background-color: var(--naranja-cacahuate);

            color: var(--fondo-oscuro);

            width: 60px; height: 60px;

            border-radius: 50%;

            display: flex;

            justify-content: center;

            align-items: center;

            font-size: 28px;

            cursor: pointer;

            transition: transform 0.3s;

            z-index: 1001;

            box-shadow: 0 4px 12px rgba(0,0,0,0.3);

            border: none;

        }

        .cart-btn:hover { transform: scale(1.1); }

        .cart-counter {

            position: absolute;

            top: -5px; right: -5px;

            background-color: var(--verde-whatsapp);

            color: var(--blanco-puro);

            border-radius: 50%;

            width: 24px; height: 24px;

            font-size: 14px;

            font-weight: bold;

            display: flex;

            justify-content: center;

            align-items: center;

        }

        #cartModal .modal-content { max-width: 500px; }

        #cartItemsContainer {

            margin-bottom: 20px;

            max-height: 40vh;

            overflow-y: auto;

        }

        .cart-item {

            display: flex;

            align-items: center;

            margin-bottom: 15px;

            padding-bottom: 15px;

            border-bottom: 1px solid var(--fondo-claro-secundario);

        }

        .cart-item:last-child { border-bottom: none; }

        .cart-item img {

            width: 60px; height: 60px;

            border-radius: 8px;

            margin-right: 15px;

            object-fit: cover;

        }

        .cart-item-info { flex-grow: 1; text-align: left; }

        .cart-item-info h4 { margin: 0; color: var(--texto-claro); }

        #emptyCartMessage { color: var(--marron-oscuro-texto); padding: 20px 0; }

        .whatsapp-direct-btn {

            position: fixed;

            bottom: 20px; left: 20px;

            background-color: var(--verde-whatsapp);

            color: var(--blanco-puro);

            width: 60px; height: 60px;

            border-radius: 50%;

            display: flex;

            justify-content: center;

            align-items: center;

            font-size: 30px;

            cursor: pointer;

            transition: transform 0.3s;

            z-index: 1001;

            box-shadow: 0 4px 12px rgba(0,0,0,0.3);

            text-decoration: none;

        }

        .whatsapp-direct-btn:hover { transform: scale(1.1); }

        footer {

            background-color: #252525;

            text-align: center;

            padding: 40px 20px;

            margin-top: 60px;

        }

        #loading-indicator {

            text-align: center;

            padding: 80px 20px;

            font-size: 1.5em;

            color: var(--naranja-cacahuate);

        }

        .fade-in {

            opacity: 0;

            transform: translateY(30px);

            transition: opacity 0.6s ease-out, transform 0.6s ease-out;

        }

        .fade-in.is-visible {

            opacity: 1;

            transform: translateY(0);

        }

        @media (max-width: 1200px) { .cards-grid { grid-template-columns: repeat(3, 1fr); } }

       

       @media (max-width: 992px) {

          body.menu-open  {

    overflow: hidden; /* Bloquea scroll del fondo */

}

            .cards-grid { grid-template-columns: repeat(2, 1fr); }



            /* --- Contenedor principal del menú (Define TODO menos el display) --- */

         

               .nav-links {

                display: none;

                position: fixed; /* Fijo a la pantalla */

                z-index: 1000;

                top: 60px; /* Distancia desde arriba (altura de tu .main-nav) */

                left: 0;

                bottom: 0; /* Se estira hasta abajo */

                width: 100%;

                background-color: rgba(26, 26, 26, 0.98); /* Fondo real */

               

                /* --- Propiedades de Layout y Scroll --- */

                flex-direction: column; /* APILA VERTICALMENTE */

                align-items: stretch; /* Estira hijos al 100% */

                overflow-y: auto; /* ¡EL SCROLL VERTICAL! */

               

                padding: 10px 0 80px 0; /* Padding (importante el inferior) */

                box-sizing: border-box;

                -webkit-overflow-scrolling: touch; /* Scroll suave en iOS */

            }



            /* --- Menú cuando está ACTIVO --- */

            .nav-links.active {

                display: flex; /* ¡Lo único que hace es hacerlo visible! */

            }



            .hamburger-menu { display: block; }



            /* --- Hijos del menú --- */

            .main-nav a, .dropdown .dropbtn {

                 width: 100%;

                 text-align: center;

                 padding: 12px 15px;

                 box-sizing: border-box;

            }

            .dropdown {

                 position: static;

                 width: 100%;

            }

            .dropdown-content {

                position: static;

                box-shadow: none;

                background-color: rgba(0, 0, 0, 0.2);

                width: 100%;

                border-radius: 0;

                padding: 0;

                display: none; /* Controlado por JS */

            }

            .dropdown-content a {

                text-align: center;

                color: var(--azul-terroso-claro);

                padding: 10px 15px;

            }

        }

               

       @media (max-width: 768px) {

    .content-section h1 { font-size: 3em; }

    .logo-container { max-width: 180px; }

    .cards-grid { padding: 25px; gap: 30px; }



    /* ▼ PEGAR EL CÓDIGO NUEVO AQUÍ ▼ */

    .card .card-actions {

        flex-wrap: wrap;         /* Permite que los botones pasen a la línea de abajo */

        gap: 12px;               /* Añade un espacio entre los botones */

        justify-content: center; /* Centra los botones */

    }

   

    .card .quantity-selector {

        width: 100%;             /* Hace que el selector [- 1 +] ocupe toda la primera línea */

        justify-content: center; /* Centra los botones [- 1 +] */

    }



    .card .add-to-cart-btn {

        flex-grow: 1; /* Hace que el botón "Añadir" ocupe el espacio disponible */

    }

    /* ▲ HASTA AQUÍ ▲ */

   

}

        /*

========================================

--- LÓGICA DEL NUEVO MENÚ MÓVIL (PANELES) ---

========================================

*/



/* 1. Ocultar el menú de escritorio en móviles */

@media (max-width: 992px) {

    .main-nav .nav-links {

        display: none !important; /* Ocultamos el menú de escritorio (el .nav-links original) */

    }

}



/* 2. Estilo del Contenedor/Bandeja Principal */

#mobile-menu-container {

    display: block;

    position: fixed;

    top: 60px; /* Altura de tu barra de nav */

    left: 0;

    bottom: 0;

    width: 100%;

    background-color: rgba(26, 26, 26, 0.98);

    z-index: 1000;

   

    /* Empieza oculto fuera de la pantalla (a la izquierda) */

    transform: translateX(-100%);

    transition: transform 0.3s ease-out;



    /* Importante: Oculta los paneles que se "salen" */

    overflow-x: hidden;

}



/* 3. Estado "Abierto" del Contenedor */

#mobile-menu-container.open {

    transform: translateX(0); /* Lo trae a la pantalla */

}



/* 4. Estilo de CADA Panel (Categorías y Subcategorías) */

.mobile-panel {

    position: absolute;

    top: 0;

    left: 0;

    width: 100%;

    height: 100%; /* Ocupa toda la bandeja */

   

    /* Cada panel tendrá su propio scroll vertical */

    overflow-y: auto;

    padding: 10px 0 80px 0;

    box-sizing: border-box;

   

    /* Animación de deslizamiento */

    transition: transform 0.3s ease-out;

}



/* 5. Posición de los Paneles */

.mobile-panel.main-panel {

    transform: translateX(0); /* El panel principal está en 0 */

}

.mobile-panel.sub-panel {

    transform: translateX(100%); /* Los subpaneles están ocultos a la derecha */

}



/* 6. Estado "Activo" de los Paneles */

/* Cuando un subpanel está activo, se mueve a 0 */

.mobile-panel.sub-panel.active {

    transform: translateX(0);

}

/* Cuando un subpanel está activo, el panel principal se mueve a la izquierda */

#mobile-menu-container.sub-panel-active .main-panel {

    transform: translateX(-100%);

}



/* 7. Estilos de los Enlaces del Menú Móvil */

.mobile-panel a {

    display: flex;

    justify-content: space-between;

    align-items: center;

    padding: 15px 20px;

    color: var(--texto-claro);

    text-decoration: none;

    font-size: 1.1em;

    font-weight: 700;

    border-bottom: 1px solid var(--fondo-claro-secundario);

}

.mobile-panel a:hover {

    background-color: var(--naranja-cacahuate);

    color: var(--fondo-oscuro);

}



/* Estilo del botón "Volver" */

.mobile-nav-back {

    color: var(--naranja-cacahuate) !important;

    font-size: 1em !important;

    border-bottom: 2px solid var(--naranja-cacahuate) !important;

}

.mobile-nav-back i {

    margin-right: 10px;

}

.mobile-panel-title {

    padding: 10px 20px;

    font-family: 'Merriweather', serif;

    color: var(--naranja-cacahuate);

    font-size: 1.5em;

    margin: 0;

    border-bottom: 1px solid var(--fondo-claro-secundario);

}


/*
========================================
--- ESTILOS DE MODAL REESTRUCTURADO ---
========================================
*/
.modal-description {
    /* Resetea cualquier regla de truncado que pueda heredar */
    height: auto !important;
    max-height: none !important;
    overflow: visible !important;
    display: block !important;
    -webkit-line-clamp: none !important;
    line-clamp: none !important;
    
    /* Estilos de espaciado */
    margin-bottom: 15px;
}

.modal-price {
    /* Estilos para el nuevo párrafo de precio */
    color: var(--azul-terroso-claro); 
    font-weight: bold;
    margin-top: 15px;
    margin-bottom: 20px; /* Espacio antes del botón de WhatsApp */
}

    </style>

    <link rel="icon" type="image/png" href="favicon-96x96.png" sizes="96x96" />

<link rel="icon" type="image/svg+xml" href="favicon.svg" />

<link rel="shortcut icon" href="favicon.ico" />

<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />

<link rel="manifest" href="site.webmanifest" />

</head>



<body>



    <header>

        <div class="header-background">

            <img src="https://i.imgur.com/BCGbBgz.jpeg" alt="Fondo de especias y hierbas">

        </div>

        <div class="header-content">

            <div class="logo-container">

                <img src="https://i.imgur.com/QPR06jn.png" alt="Logo de CACAHUATE NATURAL MARKET">

            </div>

            <div class="address-container">

                <a href="https://www.google.com/maps/search/?api=1&query=CACAHUATE+NATURAL+MARKET+Coronel+D%27+Elia+2039%2C+Lan%C3%BAs" target="_blank" style="text-decoration: none; color: inherit;">

                    <p class="address-header"><i class="fas fa-map-marker-alt"></i> Coronel D' Elia 2039, Lanús, Buenos Aires</p>

                </a>

            </div>

        </div>

    </header>



    <nav class="main-nav">

        <a href="#" class="nav-logo" style="font-weight: bold; font-family: 'Merriweather', serif; font-size: 1.2em;">CACAHUATE v99-TEST </a>

        <div class="nav-links" id="navLinks"></div>

        <button class="hamburger-menu" id="hamburgerMenu" aria-label="Abrir menú de navegación">

            <i class="fas fa-bars"></i>

        </button>

    </nav>



    <div id="mobile-menu-container"></div>

    <div class="search-bar-container">

        <i class="fas fa-search"></i>

        <input type="text" id="globalSearchInput" placeholder="Buscar en todo el catálogo...">

    </div>



    <p id="globalNoResultsMessage" class="no-results-message" style="text-align: center;">No se encontraron productos que coincidan con tu búsqueda.</p>



    <main id="main-content" style="display: none;">

        <div id="product-sections-container"></div>

    </main>



    <div id="loading-indicator">

        <p>Cargando catálogo de productos...</p>

    </div>



    <footer>

        <p>© 2025 CACAHUATE NATURAL MARKET. Todos los derechos reservados.</p>

    </footer>



    <a href="https://wa.me/5491133974550" target="_blank" class="whatsapp-direct-btn" title="Consulta Directa" aria-label="Contactar por WhatsApp">

        <i class="fab fa-whatsapp"></i>

    </a>

    <button id="cartBtn" class="cart-btn" title="Ver Pedido" aria-label="Ver carrito de pedidos">

        <i class="fas fa-shopping-cart"></i>

        <span id="cartCounter" class="cart-counter" style="display: none;">0</span>

    </button>



   <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close-button">×</span>
            <img id="modalImg" src="" alt="Imagen del producto">
            <h3 id="modalTitle"></h3>

                        <p id="modalDescriptionText" class="modal-description"></p>             <p id="modalPriceText" class="modal-price"></p>                                  <a id="modalWhatsappBtn" href="#" target="_blank" class="modal-whatsapp-btn"><i class="fab fa-whatsapp"></i> Consultar</a>
        </div>
    </div>

    <div id="imageZoomModal" class="modal">

        <span class="close-button">×</span>

        <img id="zoomImg" class="modal-content" alt="Imagen ampliada">

    </div>

    <div id="cartModal" class="modal">

        <div class="modal-content">

            <span class="close-button">×</span>

            <h3>Mi Pedido</h3>

            <div id="cartItemsContainer">

                <p id="emptyCartMessage">Tu carrito está vacío.</p>

            </div>

            <div class="cart-summary">

                <h4 id="cartTotal">Total: $0</h4>

            </div>

            <a id="checkoutBtn" href="#" target="_blank" class="modal-whatsapp-btn"><i class="fab fa-whatsapp"></i> Realizar Pedido</a>

        </div>

    </div>

<script>

    document.addEventListener('DOMContentLoaded', () => {



        const API = {

            data: null,

            async fetchData() {

                try {

                    const response = await fetch('./productos.json'); // RUTA CORREGIDA

                    if (!response.ok) throw new Error(`Error HTTP: ${response.status}`);

                    this.data = await response.json();

                    return true;

                } catch (error) {

                    console.error("No se pudieron cargar los datos de los productos:", error);

                    document.getElementById('loading-indicator').innerHTML = '<p style="color:var(--rojo-error);">Error al cargar el catálogo. Por favor, intenta de nuevo más tarde.</p>';

                    return false;

                }

            },

            getPhoneNumber() {

                return this.data ? this.data.phoneNumber : '5491133974550';

            }

        };



        const Store = {

            state: { cart: [] },

            loadCart() {

                const savedCart = localStorage.getItem('cacahuateCart');

                if (savedCart) this.state.cart = JSON.parse(savedCart);

            },

            saveCart() {

                localStorage.setItem('cacahuateCart', JSON.stringify(this.state.cart));

            },

            addProduct(product, quantity) {

                const cartItem = this.getProductInCart(product.name);

                if (cartItem) {

                    cartItem.quantity += quantity;

                } else {

                    this.state.cart.push({ product: product, quantity: quantity });

                }

                this.saveCart();

            },

            updateQuantity(productName, newQuantity) {

                const cartItem = this.getProductInCart(productName);

                if (cartItem) {

                    if (newQuantity > 0) {

                        cartItem.quantity = newQuantity;

                    } else {

                        this.removeFromCart(productName);

                    }

                }

                this.saveCart();

            },

            removeFromCart(productName) {

                this.state.cart = this.state.cart.filter(item => item.product.name !== productName);

                this.saveCart();

            },

            getProductInCart(productName) {

                return this.state.cart.find(item => item.product.name === productName);

            },

            getCartTotal() {

                return this.state.cart.reduce((total, item) => {

                    const price = item.product.price || 0;

                    return total + (price * item.quantity);

                }, 0);

            }

        };



        const UI = {

            elements: {

                navLinks: document.getElementById('navLinks'),

                productSectionsContainer: document.getElementById('product-sections-container'),

                mainContent: document.getElementById('main-content'),

                loadingIndicator: document.getElementById('loading-indicator'),

                hamburgerMenu: document.getElementById('hamburgerMenu'),

                cartCounter: document.getElementById('cartCounter'),

                cartModal: document.getElementById('cartModal'),

                productModal: document.getElementById('productModal'),

                imageZoomModal: document.getElementById('imageZoomModal'),

                cartItemsContainer: document.getElementById('cartItemsContainer'),

                emptyCartMessage: document.getElementById('emptyCartMessage'),

                checkoutBtn: document.getElementById('checkoutBtn'),

                globalSearchInput: document.getElementById('globalSearchInput'),

                globalNoResultsMessage: document.getElementById('globalNoResultsMessage'),

                cartTotal: document.getElementById('cartTotal'),

            },

            formatCurrency(value) {

                return new Intl.NumberFormat('es-AR', {

                    style: 'currency',

                    currency: 'ARS'

                }).format(value);

            },

            createCardHTML(item) {

                const priceText = item.price ? this.formatCurrency(item.price) : 'Consultar precio';

                const images = Array.isArray(item.img) ? item.img : [item.img];

                const mainImage = images[0] || '';

               

                let imageHtml;

                if (images.length > 1) {

                    let thumbnailsHtml = `<div class="thumbnail-container">`;

                    images.forEach((imgUrl, index) => {

                        thumbnailsHtml += `<img src="${imgUrl}" class="thumbnail ${index === 0 ? 'active' : ''}" data-img-src="${imgUrl}" alt="Miniatura ${index + 1} de ${item.name}">`;

                    });

                    thumbnailsHtml += `</div>`;

                   

                    imageHtml = `

                        <div class="image-gallery">

                            <div class="main-image-container">

                                <img src="${mainImage}" class="main-image" alt="Imagen de ${item.name}" loading="lazy" onerror="this.onerror=null;this.src='https://placehold.co/400x400/2F2F2F/FFFFFF?text=Imagen+no+disponible';">

                            </div>

                            ${thumbnailsHtml}

                        </div>`;

                } else {

                    imageHtml = `

                        <div class="image-wrapper">

                            <img src="${mainImage}" alt="Imagen de ${item.name}" loading="lazy" onerror="this.onerror=null;this.src='https://placehold.co/400x400/2F2F2F/FFFFFF?text=Imagen+no+disponible';">

                        </div>`;

                }

               

                return `

                    <div class="card fade-in" data-name="${item.name}" data-desc="${item.desc}" data-price="${item.price || 0}" data-img='${JSON.stringify(images)}'>

                        ${imageHtml}

                        <div class="card-content">

                            <h3>${item.name}</h3>

                            <p class="description">${item.desc}</p>

                            <div class="card-price" style="font-size: 1.4em; font-weight: bold; color: var(--azul-terroso-claro); margin-bottom: 15px;">

                                ${priceText}

                            </div>

                            <div class="card-actions">

                                <div class="quantity-selector">

                                    <button class="quantity-btn decrease-qty" aria-label="Disminuir cantidad">-</button>

                                    <input type="number" class="quantity-input" value="1" min="1" name="quantity" aria-label="Cantidad">

                                    <button class="quantity-btn increase-qty" aria-label="Aumentar cantidad">+</button>

                                </div>

                                <button class="add-to-cart-btn"><i class="fas fa-cart-plus"></i></button>

                                <button class="details-btn" aria-label="Ver detalles de ${item.name}"><i class="fas fa-eye"></i></button>

                            </div>

                        </div>

                    </div>`;

            },

            renderCartItems() {

                if (Store.state.cart.length === 0) {

                    this.elements.cartItemsContainer.innerHTML = '';

                    this.elements.cartItemsContainer.appendChild(this.elements.emptyCartMessage);

                    this.elements.emptyCartMessage.style.display = 'block';

                    this.elements.checkoutBtn.style.display = 'none';

                    this.elements.cartTotal.style.display = 'none';

                } else {

                    this.elements.emptyCartMessage.style.display = 'none';

                    this.elements.checkoutBtn.style.display = 'inline-block';

                    this.elements.cartTotal.style.display = 'block';

                    this.elements.cartItemsContainer.innerHTML = Store.state.cart.map(item => {

                        const mainImage = Array.isArray(item.product.img) ? item.product.img[0] : item.product.img;

                        return `

                        <div class="cart-item" data-name="${item.product.name}">

                            <img src="${mainImage}" alt="${item.product.name}">

                            <div class="cart-item-info">

                                <h4>${item.product.name}</h4>

                                <span>${this.formatCurrency(item.product.price || 0)}</span>

                            </div>

                            <div class="quantity-selector">

                               <button class="quantity-btn decrease-qty" aria-label="Disminuir cantidad">-</button>

                               <input type="number" class="quantity-input" value="${item.quantity}" min="0" name="cart-quantity" aria-label="Cantidad">

                               <button class="quantity-btn increase-qty" aria-label="Aumentar cantidad">+</button>

                            </div>

                        </div>`;

                    }).join('');

                    const total = Store.getCartTotal();

                    this.elements.cartTotal.textContent = `Total: ${this.formatCurrency(total)}`;

                    let productList = "Hola, quisiera realizar un pedido de los siguientes productos:\n\n";

                    Store.state.cart.forEach(item => {

                        const price = item.product.price || 0;

                        productList += `- ${item.product.name} (x${item.quantity}) = ${this.formatCurrency(price * item.quantity)}\n`;

                    });

                    productList += `\n*Total estimado: ${this.formatCurrency(total)}*`;

                    const message = encodeURIComponent(productList);

                    this.elements.checkoutBtn.href = `https://wa.me/${API.getPhoneNumber()}?text=${message}`;

                }

            },

            updateCartCounter() {

                const totalItems = Store.state.cart.reduce((sum, item) => sum + item.quantity, 0);

                this.elements.cartCounter.textContent = totalItems;

                this.elements.cartCounter.style.display = totalItems > 0 ? 'flex' : 'none';

            },

            renderLayout() {

                // Esta función ahora SOLO renderiza el menú de escritorio

                API.data.categories.sort((a, b) => a.title.localeCompare(b.title));

                API.data.categories.forEach(category => {

                    if (category.subcategories) {

                        category.subcategories.sort((a, b) => a.title.localeCompare(b.title));

                        const dropdownHTML = `<div class="dropdown"><button class="dropbtn">${category.title} <i class="fas fa-caret-down"></i></button><div class="dropdown-content">${category.subcategories.map(sub => `<a href="#${sub.id}-section">${sub.title}</a>`).join('')}</div></div>`;

                        this.elements.navLinks.innerHTML += dropdownHTML;

                        category.subcategories.forEach(sub => this.renderSection(sub.id, sub.title, sub.desc));

                    } else {

                        this.elements.navLinks.innerHTML += `<a href="#${category.id}-section">${category.title}</a>`;

                        this.renderSection(category.id, category.title, category.desc);

                    }

                });

            },



            // --- [NUEVA FUNCIÓN] ---

            // Esta función construye el nuevo menú móvil de paneles

            buildMobileMenu() {

                const container = document.getElementById('mobile-menu-container');

                if (!container) return;



                let mainPanelHTML = `<div class="mobile-panel main-panel active">`;

                let subPanelsHTML = '';



                API.data.categories.forEach(category => {

                    if (category.subcategories) {

                        // 1. Enlace que "dispara" el subpanel

                        mainPanelHTML += `<a href="#" class="mobile-nav-trigger" data-target-panel="panel-${category.id}">

                                            ${category.title}

                                            <i class="fas fa-chevron-right"></i>

                                          </a>`;

                       

                        // 2. Construir el subpanel

                        subPanelsHTML += `<div class="mobile-panel sub-panel" id="panel-${category.id}">`;

                        // Botón de Volver

                        subPanelsHTML += `<a href="#" class="mobile-nav-back">

                                            <i class="fas fa-chevron-left"></i>

                                            Volver a Categorías

                                         </a>`;

                        // Título del panel

                        subPanelsHTML += `<h4 class="mobile-panel-title">${category.title}</h4>`;

                        // Lista de subcategorías

                        category.subcategories.forEach(sub => {

                            subPanelsHTML += `<a href="#${sub.id}-section" class="mobile-nav-link">${sub.title}</a>`;

                        });

                        subPanelsHTML += `</div>`;

                   

                    } else {

                        // Enlace final (sin submenú)

                        mainPanelHTML += `<a href="#${category.id}-section" class="mobile-nav-link">${category.title}</a>`;

                    }

                });



                mainPanelHTML += `</div>`;

                container.innerHTML = mainPanelHTML + subPanelsHTML;

               

            },

            // --- [FIN DE NUEVA FUNCIÓN] ---



            renderSection(id, title, desc) {

                const sectionHTML = `<section id="${id}-section" class="content-section fade-in"><h1>${title}</h1><p>${desc || ''}</p></section><div id="${id}-grid" class="cards-grid"></div>`;

                this.elements.productSectionsContainer.innerHTML += sectionHTML;

            },

            renderAllProducts() {

                for (const categoryId in API.data.products) {

                    API.data.products[categoryId].sort((a, b) => a.name.localeCompare(b.name));

                    const grid = document.getElementById(`${categoryId}-grid`);

                    if (grid) {

                        grid.innerHTML = API.data.products[categoryId].map(item => this.createCardHTML(item)).join('');

                    }

                }

            },

            toggleModal(modal, show) {

                modal.style.display = show ? "flex" : "none";



            },

     openProductModal(card) {
                const name = card.dataset.name;
                const price = card.dataset.price;
                const desc = card.dataset.desc;
                const images = JSON.parse(card.dataset.img || '[]');
                
                document.getElementById("modalTitle").textContent = name;
                document.getElementById("modalImg").src = images[0] || 'https://placehold.co/400x400/2F2F2F/FFFFFF?text=Imagen+no+disponible';
                
                // --- LÓGICA NUEVA ---
                // Ponemos la descripción en su propio párrafo
                document.getElementById("modalDescriptionText").textContent = desc;
                
                // Ponemos el precio en su propio párrafo
                const priceElement = document.getElementById("modalPriceText");
                priceElement.innerHTML = `<strong style='font-size:1.2em;'>Precio: ${this.formatCurrency(parseFloat(price || '0'))}</strong>`;
                // --- FIN DE LÓGICA NUEVA ---

                const whatsappLink = `https://wa.me/${API.getPhoneNumber()}?text=${encodeURIComponent(`Hola, quisiera consultar sobre el producto: ${name}`)}`;
                document.getElementById("modalWhatsappBtn").href = whatsappLink;
                
                this.toggleModal(this.elements.productModal, true);
            },

            showMainContent() {

                this.elements.loadingIndicator.style.display = 'none';

                this.elements.mainContent.style.display = 'block';

            },

            initScrollAnimations() {

                const observer = new IntersectionObserver((entries) => {

                    entries.forEach(entry => {

                        if (entry.isIntersecting) entry.target.classList.add('is-visible');

                    });

                }, { threshold: 0.1 });

                document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

            }

        };

       

        const App = {

            async init() {

                const dataLoaded = await API.fetchData();

                if (!dataLoaded) return;

                Store.loadCart();

                UI.renderLayout();

               

                // --- [LÍNEA AÑADIDA] ---

                UI.buildMobileMenu(); // Construye el nuevo menú móvil

                // --- [FIN DE LÍNEA AÑADIDA] ---



                UI.renderAllProducts();

                UI.updateCartCounter();

                UI.showMainContent();

                UI.initScrollAnimations();

                this.setupEventListeners();

            },

            setupEventListeners() {

                // Eventos para las tarjetas de productos

                document.body.addEventListener('click', (e) => {

                    const card = e.target.closest('.card');

                    if (card) {

                        if (e.target.matches('.thumbnail')) {

                            const mainImage = card.querySelector('.main-image');

                            const newSrc = e.target.dataset.imgSrc;

                            if (mainImage && newSrc) mainImage.src = newSrc;

                            card.querySelectorAll('.thumbnail').forEach(thumb => thumb.classList.remove('active'));

                            e.target.classList.add('active');

                        } else if (e.target.closest('.main-image-container, .image-wrapper')) {

                            const imageToZoom = card.querySelector('.main-image') || card.querySelector('.image-wrapper img');

                            if (imageToZoom) UI.openZoomModal(imageToZoom.src);

                        } else if (e.target.closest('.details-btn')) {

                            UI.openProductModal(card);

                        } else if (e.target.closest('.add-to-cart-btn')) {

                            const quantityInput = card.querySelector('.quantity-input');

                            const quantity = parseInt(quantityInput.value, 10);

                            if (quantity > 0) {

                                const product = { name: card.dataset.name, img: JSON.parse(card.dataset.img || '[]'), price: parseFloat(card.dataset.price || '0') };

                                Store.addProduct(product, quantity);

                                UI.updateCartCounter();

                                if(quantityInput) quantityInput.value = 1;

                            }

                        } else if (e.target.matches('.quantity-btn')) {

                            const input = card.querySelector('.quantity-input');

                            if(input){

                                let currentValue = parseInt(input.value, 10);

                                if (e.target.matches('.increase-qty')) {

                                    input.value = currentValue + 1;

                                } else if (e.target.matches('.decrease-qty') && currentValue > 1) {

                                    input.value = currentValue - 1;

                                }

                            }

                        }

                    }

                });



                // Eventos para cerrar los modales

                document.addEventListener('click', (e) => {

                     if (e.target.closest('.close-button') || e.target.classList.contains('modal')) {

                        UI.toggleModal(UI.elements.productModal, false);

                        UI.toggleModal(UI.elements.imageZoomModal, false);

                        UI.toggleModal(UI.elements.cartModal, false);

                    }

                });



                // Eventos del carrito

                UI.elements.cartModal.addEventListener('click', (e) => {

                    const cartItem = e.target.closest('.cart-item');

                    if (!cartItem) return;

                    const productName = cartItem.dataset.name;

                    const input = cartItem.querySelector('.quantity-input');

                    if(!input) return;

                    let quantity = parseInt(input.value, 10);

                    if (e.target.matches('.increase-qty')) {

                        Store.updateQuantity(productName, quantity + 1);

                    } else if (e.target.matches('.decrease-qty')) {

                        Store.updateQuantity(productName, quantity - 1);

                    }

                    UI.renderCartItems();

                    UI.updateCartCounter();

                });

                UI.elements.cartModal.addEventListener('change', (e) => {

                    if (e.target.matches('.quantity-input[name="cart-quantity"]')) {

                        const cartItem = e.target.closest('.cart-item');

                        if(!cartItem) return;

                        const productName = cartItem.dataset.name;

                        const newQuantity = parseInt(e.target.value, 10);

                        Store.updateQuantity(productName, newQuantity);

                        UI.renderCartItems();

                        UI.updateCartCounter();

                    }

                });

                document.getElementById('cartBtn').addEventListener('click', () => {

                    UI.renderCartItems();

                    UI.toggleModal(UI.elements.cartModal, true);

                });



                // --- [BLOQUE REEMPLAZADO] ---

                // Eventos de la navegación principal (NUEVA LÓGICA)

                UI.elements.hamburgerMenu.addEventListener('click', () => {

                    const container = document.getElementById('mobile-menu-container');

                    if (!container) return; // Seguridad por si no existe

                   

                    const isOpen = container.classList.toggle('open');

                    document.body.classList.toggle('menu-open', isOpen);

                    document.documentElement.classList.toggle('menu-open', isOpen);



                    // Si cerramos, forzamos el regreso al panel principal

                    if (!isOpen) {

                        container.classList.remove('sub-panel-active');

                        const mainPanel = container.querySelector('.mobile-panel.main-panel');

                        if (mainPanel) mainPanel.classList.add('active');

                        container.querySelectorAll('.mobile-panel.sub-panel').forEach(p => p.classList.remove('active'));

                    }

                });

                // --- [FIN DEL BLOQUE REEMPLAZADO] ---



                UI.elements.globalSearchInput.addEventListener('input', () => App.handleSearch());



                // --- [NUEVO LISTENER AÑADIDO] ---

                // Listener para los clics DENTRO del nuevo menú móvil

                document.getElementById('mobile-menu-container').addEventListener('click', (e) => {

                    const container = document.getElementById('mobile-menu-container');

                   

                    // 1. Clic en un "disparador" (ej. "Alfajores")

                    const trigger = e.target.closest('.mobile-nav-trigger');

                    if (trigger) {

                        e.preventDefault();

                        const targetPanelId = trigger.dataset.targetPanel;

                        container.classList.add('sub-panel-active'); // Desliza el panel principal

                        const targetPanel = container.querySelector(`#${targetPanelId}`);

                        if (targetPanel) targetPanel.classList.add('active'); // Muestra el subpanel

                    }



                    // 2. Clic en "Volver"

                    const backButton = e.target.closest('.mobile-nav-back');

                    if (backButton) {

                        e.preventDefault();

                        container.classList.remove('sub-panel-active'); // Regresa el panel principal

                        if (backButton.closest('.mobile-panel')) {

                            backButton.closest('.mobile-panel').classList.remove('active'); // Oculta este subpanel

                        }

                    }



                    // 3. Clic en un enlace final (ej. "#situ-natural" o "#especias")

                    const finalLink = e.target.closest('.mobile-nav-link');

                    if (finalLink) {

                        // El enlace navegará al #id... solo cerramos el menú.

                        container.classList.remove('open');

                        document.body.classList.remove('menu-open');

                        document.documentElement.classList.remove('menu-open');

                       

                        // Forzar el reseteo al panel principal para la próxima vez que se abra

                        container.classList.remove('sub-panel-active');

                        container.querySelectorAll('.sub-panel').forEach(p => p.classList.remove('active'));

                    }

                });

                // --- [FIN DEL NUEVO LISTENER] ---

               

                // --- [BLOQUE BORRADO] ---

                // El antiguo 'document.querySelectorAll('.dropdown .dropbtn')...' ha sido eliminado.



            }, // Fin de setupEventListeners



            handleSearch() {

                const searchTerm = (UI.elements.globalSearchInput.value || '').toLowerCase().trim();

                let totalVisibleCards = 0;

                document.querySelectorAll('.cards-grid').forEach(grid => {

                    let visibleCardsInGrid = 0;

                    grid.querySelectorAll('.card').forEach(card => {

                        const name = (card.dataset.name || '').toLowerCase();

                        const desc = (card.dataset.desc || '').toLowerCase();

                        const isMatch = name.includes(searchTerm) || desc.includes(searchTerm);

                        card.style.display = isMatch ? 'flex' : 'none';

                        if(isMatch) {

                            visibleCardsInGrid++;

                            totalVisibleCards++;

                        }

                    });

                    const section = grid.previousElementSibling;

                    if(section && section.classList.contains('content-section')){

                        section.style.display = visibleCardsInGrid > 0 ? 'block' : 'none';

                    }

                });

                 UI.elements.globalNoResultsMessage.style.display = totalVisibleCards === 0 && searchTerm !== '' ? 'block' : 'none';

            } // Fin de handleSearch

        }; // Fin del objeto App

       

        App.init();



    });

</script>

